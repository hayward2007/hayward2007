<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>HAYWARD.KIM</title>
    <style>
        /* :root {
            --background-color: #000000;
            --container-color: #111113;
            --content-color: #FFFFFF;
        } */

        @font-face {
            font-family: "MonaSansExpanded";
            font-weight: bold;
            src: url("./assets/MonaSansCondensed-Bold.woff2");
        }

        * {
            margin: 0;
            padding: 0;
            color: var(--content-color);
            font-family: "MonaSansExpanded";
        }

        body {
            width: calc(100vw - 16px);
            height: calc(100vh - 16px);
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: center;
            padding: 8px;
            gap: 8px;
            background-image: url('./assets/background.svg');
            background-size: cover;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        div {
            display: flex;
        }

        .fallingDiv {
            width: 50px;
            height: 50px;
            background-color: red;
            position: absolute;
        }
    </style>
    
     <script>
        // class Element {
        //     constructor(x, y, vectorX, vectorY) {
        //         this.x = x;
        //         this.y = y;
        //         this.vx = vx;
        //         this.vy = vy;
        //     }
        // }


        document.addEventListener('DOMContentLoaded', function () {
            const numDivs = 5;
            const divs = [];
            const bodyHeight = document.body.clientHeight;
            const bodyWidth = document.body.clientWidth;
            const gravity = 0.5;
            const friction = 0.98; // 마찰력 계수

            for (let i = 0; i < numDivs; i++) {
                const div = document.createElement('div');
                div.classList.add('fallingDiv');
                div.style.left = `${Math.random() * (bodyWidth - 50)}px`;
                div.style.top = `${Math.random() * (bodyHeight / 2)}px`;
                document.body.appendChild(div);
                divs.push({
                    element: div,
                    x: parseFloat(div.style.left),
                    y: parseFloat(div.style.top),
                    vy: Math.random() * 5 + 2,
                    vx: Math.random() * 2 - 1
                });
            }

            function detectCollision(div1, div2) {
                return (
                    div1.x < div2.x + 50 &&
                    div1.x + 50 > div2.x &&
                    div1.y < div2.y + 50 &&
                    div1.y + 50 > div2.y
                );
            }

            function resolveCollision(div1, div2) {
                // 간단한 충돌 해결: 위치를 조정하여 겹치지 않도록 함
                const overlapX = (div1.x + 50 - div2.x) / 2;
                const overlapY = (div1.y + 50 - div2.y) / 2;

                if (overlapX > overlapY) {
                    if (div1.y < div2.y) {
                        div1.y -= overlapY;
                        div2.y += overlapY;
                    } else {
                        div1.y += overlapY;
                        div2.y -= overlapY;
                    }
                } else {
                    if (div1.x < div2.x) {
                        div1.x -= overlapX;
                        div2.x += overlapX;
                    } else {
                        div1.x += overlapX;
                        div2.x -= overlapX;
                    }
                }

                // 속도 교환
                const tempVy = div1.vy;
                const tempVx = div1.vx;
                div1.vy = div2.vy;
                div1.vx = div2.vx;
                div2.vy = tempVy;
                div2.vx = tempVx;
            }

            function animate() {
                divs.forEach(div => {
                    div.vy += gravity;
                    div.y += div.vy;
                    div.x += div.vx;

                    if (div.y + 50 > bodyHeight) {
                        div.y = bodyHeight - 50;
                        div.vy = 0; // 속도를 0으로 설정
                        div.vx *= friction; // 마찰력 적용
                    }

                    if (div.x + 50 > bodyWidth || div.x < 0) {
                        div.vx *= -1;
                    }

                    divs.forEach(otherDiv => {
                        if (div !== otherDiv && detectCollision(div, otherDiv)) {
                            resolveCollision(div, otherDiv);
                        }
                    });

                    div.element.style.top = `${div.y}px`;
                    div.element.style.left = `${div.x}px`;
                });

                requestAnimationFrame(animate);
            }

            animate();
        });
    </script>
</head>
<body>
</body>
</html>